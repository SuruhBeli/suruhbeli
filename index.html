<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#FB923C">
  <link rel="icon" href="ikon-512.png">
  <title>SuruhBeli - Beranda</title>

  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">

<!-- Firebase 10 compat -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

<style>
  :root{
    --bg-main:#FFF7ED;
    --text-main:#7C2D12;
    --card-bg:#ffffff;
    --border-soft:#FED7AA;
    --text-secondary:#374151;
    --text-muted:#6B7280;
    --accent:#FB923C;
    --active-bg:#FFF1E6;
    --banner-gradient-start:#FB923C;
    --banner-gradient-end:#F97316;
    --banner-shadow: rgba(251, 146, 60, 0.35);
    --btn-shadow: rgba(251, 146, 60, 0.45);
    --service-desc:#8a6a58;
    --footer-text:#9a6b4f;
    --scroll-header-bg:#FB923C;
    --scroll-header-text:#ffffff;
    --popup-title:#7C2D12;
    --popup-desc:#8a6a58;
    --dot-inactive:#ccc;
    --navbar-bg: #FFF7ED;
    --navbar-text: #6B7280;
    --navbar-active-bg: #FB923C;
    --navbar-active-text: #FB923C;
    --navbar-border-radius: 35px;
    --navbar-shadow: 0 8px 20px rgba(0,0,0,0.15);
    --navbar-glass-bg: rgba(255,255,255,0.55);
    --navbar-glass-border: 1px solid rgba(255,255,255,0.35);
    --navbar-glass-blur: blur(14px);
    --nav-circle-shadow: none;
  }

  body.dark-mode{
    --bg-main:#0F172A;
    --text-main:#F8FAFC;
    --card-bg:#1E293B;
    --border-soft:#334155;
    --text-secondary:#E2E8F0;
    --text-muted:#94A3B8;
    --accent:#FB923C;
    --active-bg:#1E293B;
    --banner-gradient-start:#FB923C;
    --banner-gradient-end:#F97316;
    --banner-shadow: rgba(251, 146, 60, 0.35);
    --btn-shadow: rgba(251, 146, 60, 0.45);
    --service-desc:#8a6a58;
    --footer-text:#9a6b4f;
    --scroll-header-bg:#FB923C;
    --scroll-header-text:#ffffff;
    --popup-title:#7C2D12;
    --popup-desc:#8a6a58;
    --dot-inactive:#ccc;
    --navbar-bg: rgba(30,41,59,0.85);
    --navbar-text: #94A3B8;
    --navbar-active-bg: #FB923C;
    --navbar-active-text: #FB923C;
    --navbar-shadow: 0 10px 30px rgba(0,0,0,0.45);
    --navbar-glass-bg: rgba(15,23,42,0.65);
    --navbar-glass-border: 1px solid rgba(148,163,184,0.15);
    --navbar-glass-blur: blur(16px);
    --nav-circle-shadow:
      0 8px 22px rgba(0,0,0,0.35),
      inset 0 2px 6px rgba(255,255,255,0.08);
  }

  body{
    background: var(--bg-main);
    color: var(--text-main);
    transition: background 0.3s ease, color 0.3s ease;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    padding-top: env(safe-area-inset-top, 44px);
    padding-bottom: 90px;
    font-family: 'Nunito', sans-serif;
    -webkit-tap-highlight-color: transparent;
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    user-select:none;
    -webkit-user-select:none;
    outline:none;
  }

  /* ===== TOP BAR IMAGE ===== */
  .top-bar {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: env(safe-area-inset-top, 44px);
    background-image: url('ikon-512.png');
    background-size: cover;
    background-position: center;
    z-index: 9999;
    opacity: 0;
    transition: opacity 0.2s ease;
  }

  .logo-top {
    position: fixed;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    align-items: center;
    gap: 8px;
    z-index: 9999;
  }

  .logo-top img {
    width: 28px;
    height: 28px;
    object-fit: cover;
  }

  .logo-top span {
    font-weight: 700;
    font-size: 16px;
    color: var(--text-main);
    white-space: nowrap;
  }

  header {
    height: 24px;
  }

  .scroll-header {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 50px;
    background: var(--scroll-header-bg);
    color: var(--scroll-header-text);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 16px;
    z-index: 1000;
    border-radius: 0 0 12px 12px;
    opacity: 0;
    transition: opacity 0.1s ease;
  }

  .container {
    padding: 16px;
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  /* ===== CARD HEADER ===== */
  .top-card {
    background: var(--card-bg);
    border-radius: 18px;
    padding: 16px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.05);
    border: 1px solid var(--border-soft);
  }

  .brand {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 8px;
  }

  .brand img {
    width: 42px;
    height: 42px;
    border-radius: 12px;
    object-fit: cover;
  }

  .brand h1 {
    font-size: 20px;
    font-weight: 800;
    color: var(--text-main);
  }

  .wilayah {
    font-size: 13px;
    color: var(--text-secondary);
    margin-top: 2px;
  }

  .welcome {
    margin-top: 10px;
    font-size: 14px;
    font-weight: 600;
  }

  /* ===== BANNER INFO ===== */
  .banner {
    background: linear-gradient(135deg, var(--banner-gradient-start), var(--banner-gradient-end));
    color: var(--scroll-header-text);
    border-radius: 18px;
    padding: 18px;
    box-shadow: 0 10px 25px var(--banner-shadow);
    margin-top: -60px;
  }

  .banner h2 {
    font-size: 18px;
    margin-bottom: 6px;
    font-weight: 800;
  }

  .banner p {
    font-size: 14px;
    opacity: 0.95;
    line-height: 1.5;
  }

  /* ===== BANNER CAROUSEL ===== */
  .banner-carousel-wrapper {
    position: relative;
    overflow: hidden;
  }

  .banner-carousel-scroll {
    display: flex;
    gap: 12px;
    overflow-x: auto;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    padding-bottom: 8px;
  }

  .banner-carousel-scroll img {
    flex-shrink: 0;
    width: calc(100% - 32px);
    height: 180px;
    object-fit: cover;
    border-radius: 12px;
  }
  .banner-carousel-scroll img {
    flex-shrink: 0;
    width: calc(100% - 32px);
    height: 180px;
    object-fit: cover;
    border-radius: 12px;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  
  /* Hover desktop */
  .banner-carousel-scroll img:hover {
    transform: scale(1.05);
    box-shadow: 0 10px 20px rgba(0,0,0,0.2);
  }
  .banner-dots {
    text-align: center;
    margin-top: 8px;
  }

  .dot {
    display: inline-block;
    width: 8px;
    height: 8px;
    margin: 0 4px;
    background: var(--dot-inactive);
    border-radius: 50%;
    cursor: pointer;
  }

  .dot.active {
    background: var(--accent);
  }

  /* ===== GRID LAYANAN ===== */
  .section-title {
    font-size: 16px;
    font-weight: 800;
    margin-top: 4px;
  }

  .grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 14px;
  }

  .service-card {
    background: var(--card-bg);
    border-radius: 18px;
    padding: 18px 14px;
    text-align: center;
    box-shadow: 0 8px 18px rgba(0, 0, 0, 0.05);
    border: 1px solid var(--border-soft);
    cursor: pointer;
    transition: 0.2s ease;
    user-select: none;
  }

  .service-card:active {
    transform: scale(0.97);
  }

  .service-icon {
    font-size: 28px;
    margin-bottom: 6px;
  }

  .service-title {
    font-weight: 800;
    font-size: 14px;
  }

  .service-desc {
    font-size: 12px;
    color: var(--service-desc);
    margin-top: 4px;
  }

  /* ===== CTA BUTTON ===== */
  .cta {
    margin-top: auto;
  }

  .btn-order {
    width: 100%;
    padding: 16px;
    border: none;
    border-radius: 16px;
    background: var(--accent);
    color: var(--scroll-header-text);
    font-size: 17px;
    font-weight: 800;
    box-shadow: 0 8px 20px var(--btn-shadow);
    cursor: pointer;
    transition: 0.2s ease;
  }

  .btn-order:active {
    transform: scale(0.98);
  }

  .footer {
    text-align: center;
    font-size: 12px;
    color: var(--footer-text);
    padding-bottom: 10px;
  }

  /* Overlay blur */
  .auth-lock {
    position: fixed;
    inset: 0;
    background: rgba(255, 255, 255, 0.15); /* semi transparan */
    backdrop-filter: blur(6px); /* blur efek */
    display: none;
    z-index: 999;
    transition: opacity 0.3s ease;
  }
  
  /* Popup glassmorphism */
  .login-popup {
    position: fixed;
    bottom: -100%;
    left: 50%;
    transform: translateX(-50%);
    width: 90%;
    max-width: 400px;
    background: var(--bg-main);
    backdrop-filter: blur(10px);
    border-radius: 24px;
    padding: 20px 18px 24px;
    box-shadow: 0 8px 30px rgba(0,0,0,0.2);
    transition: bottom 0.4s ease;
    z-index: 1000;
  }
  
  .login-popup.active {
    bottom: 60px; /* muncul ke atas */
  }
  
  .login-popup .btn-login {
    background: rgba(251, 146, 60, 0.85);
    color: #fff;
    font-weight: 700;
    font-size: 15px;
    border-radius: 14px;
    padding: 14px;
    width: 100%;
    border: none;
    cursor: pointer;
    transition: 0.2s;
  }
  
  .login-popup .btn-login:active {
    transform: scale(0.97);
  }

  .popup-title {
    font-size: 18px;
    font-weight: 800;
    text-align: center;
    margin-bottom: 6px;
    color: var(--popup-title);
  }

  .popup-desc {
    font-size: 13px;
    text-align: center;
    color: var(--popup-desc);
    margin-bottom: 16px;
    line-height: 1.5;
  }

  .btn-login {
    width: 100%;
    padding: 14px;
    border: none;
    border-radius: 14px;
    background: var(--accent);
    color: var(--scroll-header-text);
    font-weight: 800;
    font-size: 15px;
    cursor: pointer;
  }
/* NAVBAR */
.navbar-bottom {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  width: 90%;
  max-width: 450px;
  height: 70px;

  background: var(--navbar-bg);
  border-radius: var(--navbar-border-radius);
  box-shadow: var(--navbar-shadow);

  display: flex;
  justify-content: space-around;
  align-items: center;
  z-index: 100;
  transition: all 0.35s ease;
}
/* ===============================
   MODE GEMPA / TRUE GLASSMORPHISM
   =============================== */
.navbar-bottom.gempa-mode{
  background: var(--navbar-glass-bg);
  backdrop-filter: blur(18px) saturate(140%);
  -webkit-backdrop-filter: blur(18px) saturate(140%);
  border: var(--navbar-glass-border);

  /* Shadow glass (lebih premium, tidak berat) */
  box-shadow:
    0 10px 30px rgba(0,0,0,0.25),
    inset 0 1px 0 rgba(255,255,255,0.15);
}

/* Highlight tipis biar efek glass lebih hidup */
.navbar-bottom.gempa-mode::before{
  content: "";
  position: absolute;
  top: 0;
  left: 12%;
  width: 76%;
  height: 1px;
  background: linear-gradient(
    to right,
    transparent,
    rgba(255,255,255,0.35),
    transparent
  );
  pointer-events: none;
}

/* ===============================
   NAV ITEM
   =============================== */
.nav-item {
  position: relative;
  flex: 1;
  text-align: center;
  cursor: pointer;
  color: var(--navbar-text);
  z-index: 2; /* di atas circle */
  transition: transform 0.2s ease;
}

/* Tap effect (mobile friendly hover) */
.nav-item:active{
  transform: scale(0.95);
}

/* ===============================
   ICON SVG
   =============================== */
.nav-item svg {
  width: 28px;
  height: 28px;
  fill: none;
  stroke: var(--navbar-text);
  stroke-width: 1.3;
  transition: 
    transform 0.4s cubic-bezier(.68,-0.55,.27,1.55),
    stroke 0.3s ease;
}

.nav-item.active svg {
  stroke: var(--navbar-active-text);
  transform: translateY(-15px) scale(1.25);
}

/* ===============================
   TEXT LABEL (FIX BUG WARNA)
   =============================== */
.nav-item span {
  display: block;
  margin-top: 1px;
  font-size: 15px;
  font-weight: 700;
  transition: transform 0.3s ease, color 0.3s ease;

  /* üî• FIX: default harus text biasa, bukan aktif */
  color: var(--navbar-text);
}

.nav-item.active span {
  transform: translateY(-5px);
  color: var(--navbar-active-text);
}

/* ===============================
   ACTIVE BACKGROUND CIRCLE (SMOOTH)
   =============================== */
.nav-active-circle {
  position: absolute;
  top: -22px;
  width: 62px;
  height: 62px;

  background: var(--border-soft);
  border-radius: 50%;

  /* pakai variable biar dinamis */
  box-shadow: var(--nav-circle-shadow);

  transition:
    left 0.45s cubic-bezier(.68,-0.55,.27,1.55),
    transform 0.3s ease;

  z-index: 1;
  pointer-events: none;
}
</style>
</head>
<body>
    <!-- TOP BAR FIXED -->
<div class="top-bar"></div>
  <!-- Logo tengah atas -->
<div class="logo-top">
  <img src="logo.png" alt="Logo" />
  <span>SuruhBeli</span>
</div>
<div class="scroll-header" id="scrollHeader">
</div>
<!-- HERO HEADER -->
<div class="hero" style="width:100%; height:300px; overflow:hidden;">
  <img id="heroImage" src="default.png" alt="Hero" style="width:100%; height:100%; object-fit:cover;">
</div>

<div class="container" style="padding:16px; flex:1; display:flex; flex-direction:column; gap:16px;">

  <!-- BANNER -->
  <div class="banner">
    <h2>Suruh Apa Saja</h2>
    <p>
      Bisa suruh beli makanan, belanjaan, atau antar barang ringan.
      Bayar di tempat (COD), cepat dan khusus wilayah lokal.
    </p>
  </div>

  <!-- LAYANAN -->
  <div class="section-title">Pilih Layanan</div>

  <div class="grid">
    <div class="service-card" onclick="goOrder('makanan')">
      <div class="service-icon">üçú</div>
      <div class="service-title">Beli Makanan</div>
      <div class="service-desc">Warung, mie ayam, dll</div>
    </div>

    <div class="service-card" onclick="goOrder('belanja')">
      <div class="service-icon">üõí</div>
      <div class="service-title">Beli Belanjaan</div>
      <div class="service-desc">Sembako & kebutuhan</div>
    </div>

    <div class="service-card" onclick="goOrder('antar')">
      <div class="service-icon">üì¶</div>
      <div class="service-title">Antar Barang</div>
      <div class="service-desc">Barang ringan saja</div>
    </div>

    <div class="service-card" onclick="goOrder('lainnya')">
      <div class="service-icon">‚ú®</div>
      <div class="service-title">Suruh Lainnya</div>
      <div class="service-desc">Custom permintaan</div>
    </div>
  </div>
    <!-- =====  ===== -->
  <div class="section-title">Promo & Banner</div>
  
  <div class="banner-carousel-wrapper">
    <div class="banner-carousel-scroll" id="bannerCarousel">
      <!-- Foto akan diisi JS -->
    </div>
    <div class="banner-dots" id="bannerDots"></div>
  </div>
 
  <!-- CTA -->
  <div class="cta">
    <button class="btn-order" onclick="goOrder('umum')">
      üü† Buat Pesanan Sekarang
    </button> 
  </div>

  <div class="footer">
    SuruhBeli ‚Ä¢ Layanan Lokal ‚Ä¢ COD ‚Ä¢ Ramah Warga
  </div>

</div>
<!-- POPUP LOGIN -->
<div class="login-popup" id="loginPopup">
  <div class="popup-title">Masuk Dulu Yuk</div>
  <div class="popup-desc">
    Untuk menggunakan layanan SuruhBeli, kamu harus masuk atau daftar terlebih dahulu.
  </div>
  <button class="btn-login" onclick="window.location.href='register.html'">
    Masuk / Daftar Sekarang
  </button>
</div>

<div id="authLock" class="auth-lock"></div>

<div class="navbar-bottom">
  <div class="nav-active-circle" id="navCircle"></div>

  <div class="nav-item" data-index="0" data-href="index.html">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
      <path d="M11.47 3.841a.75.75 0 0 1 1.06 0l8.69 8.69a.75.75 0 1 0 1.06-1.061l-8.689-8.69a2.25 2.25 0 0 0-3.182 0l-8.69 8.69a.75.75 0 1 0 1.061 1.06l8.69-8.689Z" />
      <path d="m12 5.432 8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75 0 0 1-.75-.75v-4.5a.75.75 0 0 0-.75-.75h-3a.75.75 0 0 0-.75.75V21a.75.75 0 0 1-.75.75H5.625a1.875 1.875 0 0 1-1.875-1.875v-6.198a2.29 2.29 0 0 0 .091-.086L12 5.432Z" />
    </svg>

    <span>Home</span>
  </div>
  <div class="nav-item" data-index="1" data-href="aktivitas.html">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
      <path fill-rule="evenodd" d="M7.502 6h7.128A3.375 3.375 0 0 1 18 9.375v9.375a3 3 0 0 0 3-3V6.108c0-1.505-1.125-2.811-2.664-2.94a48.972 48.972 0 0 0-.673-.05A3 3 0 0 0 15 1.5h-1.5a3 3 0 0 0-2.663 1.618c-.225.015-.45.032-.673.05C8.662 3.295 7.554 4.542 7.502 6ZM13.5 3A1.5 1.5 0 0 0 12 4.5h4.5A1.5 1.5 0 0 0 15 3h-1.5Z" clip-rule="evenodd" />
      <path fill-rule="evenodd" d="M3 9.375C3 8.339 3.84 7.5 4.875 7.5h9.75c1.036 0 1.875.84 1.875 1.875v11.25c0 1.035-.84 1.875-1.875 1.875h-9.75A1.875 1.875 0 0 1 3 20.625V9.375ZM6 12a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H6.75a.75.75 0 0 1-.75-.75V12Zm2.25 0a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75ZM6 15a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H6.75a.75.75 0 0 1-.75-.75V15Zm2.25 0a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75ZM6 18a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H6.75a.75.75 0 0 1-.75-.75V18Zm2.25 0a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd" />
    </svg>

    <span>Pesanan</span>
  </div>
  <div class="nav-item" data-index="2" data-href="profil.html">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
      <path fill-rule="evenodd" d="M18.685 19.097A9.723 9.723 0 0 0 21.75 12c0-5.385-4.365-9.75-9.75-9.75S2.25 6.615 2.25 12a9.723 9.723 0 0 0 3.065 7.097A9.716 9.716 0 0 0 12 21.75a9.716 9.716 0 0 0 6.685-2.653Zm-12.54-1.285A7.486 7.486 0 0 1 12 15a7.486 7.486 0 0 1 5.855 2.812A8.224 8.224 0 0 1 12 20.25a8.224 8.224 0 0 1-5.855-2.438ZM15.75 9a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z" clip-rule="evenodd" />
    </svg>

    <span>Profil</span>
  </div>
</div>
<script>
  // ===== FIREBASE CONFIG (PAKAI PUNYA KAMU) =====
  firebase.initializeApp({
    apiKey: "AIzaSyByQl0BXZoSMzrULUNA6l7UVFQjXmvsdJE",
    authDomain: "suruhbeli-e8ae8.firebaseapp.com",
    projectId: "suruhbeli-e8ae8"
  });

  const auth = firebase.auth();
  const db = firebase.firestore();

  const loginPopup = document.getElementById("loginPopup");
  const authLock = document.getElementById("authLock");
  const welcomeText = document.getElementById("welcomeText");

  let currentUser = null;

  // ===== AUTH CHECK =====
  auth.onAuthStateChanged(async (user) => {
    if (!user) {
      // BELUM LOGIN ‚Üí LOCK UI
      authLock.style.display = "block";
      setTimeout(() => {
        loginPopup.classList.add("active");
      }, 300);
      welcomeText.innerText = "Silakan masuk untuk menggunakan layanan";
      return;
    }

    // SUDAH LOGIN
    currentUser = user;
    authLock.style.display = "none";
    loginPopup.classList.remove("active");

    try {
      // ambil data user dari firestore (jika ada)
      const doc = await db.collection("users").doc(user.uid).get();
      if (doc.exists) {
        const data = doc.data();
        welcomeText.innerText = `Halo, ${data.nama || user.displayName || "Pengguna"} üëã`;
      } else {
        welcomeText.innerText = `Halo, ${user.displayName || "Pengguna"} üëã`;
      }
    } catch (e) {
      welcomeText.innerText = `Halo, ${user.displayName || "Pengguna"} üëã`;
    }
  });
  // ===== AMBIL HERO IMAGE DARI FIRESTORE =====
const bannerCarousel = document.getElementById("bannerCarousel");
const bannerDots = document.getElementById("bannerDots");
const heroImage = document.getElementById("heroImage");

// ===== AMBIL HERO IMAGE =====
db.collection("stockfoto").doc("foto").get()
  .then(doc => {
    if(doc.exists){
      const url = doc.data().headerhome || "default.png";
      const imgTest = new Image();
      imgTest.onload = () => { heroImage.src = url; };
      imgTest.onerror = () => { heroImage.src = "default.png"; };
      imgTest.src = url;
    } else {
      heroImage.src = "default.png";
    }
  }).catch(err => {
    console.log("Error ambil hero image:", err);
    heroImage.src = "default.png";
  });

// ===== AMBIL BANNER CAROUSEL =====
db.collection("stockfoto").doc("foto").get()
  .then(doc => {
    if(doc.exists){
      const banners = Array.isArray(doc.data().bannerhome) ? doc.data().bannerhome : ["default.png"];
      let currentIndex = 0;
      let autoScrollInterval = null;

      // Render banner & dots
      banners.forEach((url, i) => {
        // Gambar banner
        const img = document.createElement("img");
        img.src = url || "default.png";
        img.onerror = () => { img.src = "default.png"; };
        bannerCarousel.appendChild(img);

        // Dot navigasi
        const dot = document.createElement("span");
        dot.className = "dot" + (i === 0 ? " active" : "");
        dot.dataset.index = i;
        dot.onclick = () => { showBanner(i); };
        bannerDots.appendChild(dot);
      });

      // Fungsi scroll ke index banner
      function showBanner(index){
        if(bannerCarousel.children.length > 0){
          const imgWidth = bannerCarousel.children[0].offsetWidth + 12; // 12 = gap
          bannerCarousel.scrollTo({ left: imgWidth * index, behavior: 'smooth' });

          Array.from(bannerDots.children).forEach((d, i) => {
            d.classList.toggle("active", i === index);
          });

          currentIndex = index;
        }
      }

      // Auto-scroll
      function startAutoScroll(){
        stopAutoScroll(); // pastikan interval sebelumnya hilang
        if(banners.length > 1){
          autoScrollInterval = setInterval(() => {
            let nextIndex = (currentIndex + 1) % banners.length;
            showBanner(nextIndex);
          }, 3000);
        }
      }

      function stopAutoScroll(){
        clearInterval(autoScrollInterval);
      }

      startAutoScroll(); // mulai auto-scroll otomatis

      // Efek touch / hover
      const bannerImages = bannerCarousel.querySelectorAll('img');
      bannerImages.forEach(img => {
        // mobile touch
        img.addEventListener('touchstart', () => {
          img.style.transform = 'scale(1.05)';
          img.style.boxShadow = '0 10px 20px rgba(0,0,0,0.2)';
          stopAutoScroll();
        });
        img.addEventListener('touchend', () => {
          img.style.transform = '';
          img.style.boxShadow = '';
          startAutoScroll();
        });

        // desktop hover
        img.addEventListener('mouseenter', () => {
          img.style.transform = 'scale(1.05)';
          img.style.boxShadow = '0 10px 20px rgba(0,0,0,0.2)';
          stopAutoScroll();
        });
        img.addEventListener('mouseleave', () => {
          img.style.transform = '';
          img.style.boxShadow = '';
          startAutoScroll();
        });
      });

    } else {
      // fallback banner
      const img = document.createElement("img");
      img.src = "default.png";
      bannerCarousel.appendChild(img);

      const dot = document.createElement("span");
      dot.className = "dot active";
      bannerDots.appendChild(dot);
    }
  }).catch(err => {
    console.log("Error ambil bannerhome:", err);
    const img = document.createElement("img");
    img.src = "default.png";
    bannerCarousel.appendChild(img);

    const dot = document.createElement("span");
    dot.className = "dot active";
    bannerDots.appendChild(dot);
  });

// ===== NAVIGASI ORDER =====
function goOrder(jenis){
  if(!currentUser){
    loginPopup.classList.add("active");
    authLock.style.display = "block";
    return;
  }
  window.location.href = "order.html?layanan=" + jenis;
}
// Top bar muncul sesuai scroll sedikit
window.addEventListener('scroll', () => {
  const topBar = document.querySelector('.top-bar');
  const scroll = window.scrollY;
  
  // scroll 0‚Äì50px ‚Üí opacity 0‚Äì1
  topBar.style.opacity = Math.min(scroll / 50, 1);
});
const scrollHeader = document.getElementById("scrollHeader");

window.addEventListener("scroll", () => {
  const scrollY = window.scrollY;

  // opacity naik seiring scroll (max 1)
  let opacity = Math.min(scrollY / 50, 1); // scroll 50px ‚Üí opacity 1
  scrollHeader.style.opacity = opacity;
});

//SINKRON TEMA 
function loadTheme(){
  const savedTheme = localStorage.getItem("themeMode");
  if(savedTheme === "dark"){
    document.body.classList.add("dark-mode");
  }else{
    document.body.classList.remove("dark-mode");
  }
}

// Jalankan saat halaman selesai load
window.addEventListener("load", loadTheme);

/* === NAVBAR BAWAH === */
const navItems = document.querySelectorAll('.nav-item');
const navCircle = document.getElementById('navCircle');
document.querySelector('.navbar-bottom')
  .classList.toggle('gempa-mode');
  
function updateNavCircle(activeIndex) {
  const activeItem = navItems[activeIndex];
  if (!activeItem || !navCircle) return;

  // Hitung posisi center ikon relatif ke navbar
  const navbarRect = activeItem.parentElement.getBoundingClientRect();
  const icon = activeItem.querySelector('svg');
  const iconRect = icon.getBoundingClientRect();

  const centerX = iconRect.left + iconRect.width / 2 - navbarRect.left;

  navCircle.style.left = `${centerX - navCircle.offsetWidth / 2}px`;
  navCircle.style.transform = 'scale(1.15)';

  setTimeout(() => {
    navCircle.style.transform = 'scale(1)';
  }, 200);
}

// Inisialisasi tab aktif sesuai URL
let currentPage = window.location.pathname.split("/").pop() || 'index.html';
navItems.forEach((item, idx) => {
  if (item.dataset.href === currentPage) {
    item.classList.add('active');
    updateNavCircle(idx);
  }

  // Event klik
  item.addEventListener('click', (e) => {
    e.preventDefault();
    navItems.forEach(i => i.classList.remove('active'));
    item.classList.add('active');
    updateNavCircle(idx);

    setTimeout(() => {
      window.location.href = item.dataset.href;
    }, 250); // animasi bulatan selesai dulu
  });
});

// Update posisi saat resize / load
function updateActiveCircle() {
  const active = document.querySelector('.nav-item.active');
  if (active) {
    const idx = Array.from(navItems).indexOf(active);
    updateNavCircle(idx);
  }
}

window.addEventListener('resize', updateActiveCircle);
window.addEventListener('load', updateActiveCircle);

// SW INSTALL
if ("serviceWorker" in navigator) {
  window.addEventListener("load", () => {
    navigator.serviceWorker.register("/sw.js")
      .then(() => console.log("SW registered"))
      .catch(err => console.log("SW error:", err));
  });
}
</script>

</body>
</html>